@page "/movie/create"
@inherits Component
@inject IMoviesRepository rep

<h3>Create Movie</h3>

<MovieForm Movie="Movie"  OnValidSubmit="SaveMovie" NotSelectedGenre="NotSelctedGenres"/>

@*<button class="btn btn-primary" @onclick="Save">Save</button>*@

@code {

    private Movie Movie = new Movie();
    private List<Genre> NotSelctedGenres = new List<Genre>()
    {
        new Genre(){GenreID = 1, Name ="Action"},
        new Genre(){GenreID = 2, Name ="Comedy"},
        new Genre(){GenreID = 3, Name ="Drama"}
    };

    private async Task SaveMovie()
    {
        try
        {
            var moveID = await rep.CreateMovie(Movie);
            Nav.NavigateTo($"movie/edit/{moveID}/{Movie.Title.Replace(" ", "-")}");

        }
        catch (Exception)
        {

            throw;
        }
    }

}
